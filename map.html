<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HPC êµíšŒì§€ë„ | ONEBODY</title>

  <!-- Leaflet (ì§€ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬, API í‚¤ ë¶ˆí•„ìš”) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    :root{
      --bg:#0B1220;
      --card:#0F1A33;
      --soft:#101B37;
      --text:#EAF0FF;
      --muted:rgba(234,240,255,.72);
      --line:rgba(234,240,255,.12);
      --radius:18px;
      --shadow: 0 18px 60px rgba(0,0,0,.35);
      --accent:#7DD3FC;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(125,211,252,.14), transparent 60%),
        radial-gradient(900px 600px at 80% 0%, rgba(167,243,208,.12), transparent 55%),
        radial-gradient(900px 700px at 60% 100%, rgba(99,102,241,.14), transparent 55%),
        var(--bg);
    }
    header{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      padding:12px 16px; border-bottom:1px solid var(--line);
      backdrop-filter: blur(6px);
    }
    .left{display:flex; gap:8px; align-items:center;}
    .btn{
      padding:10px 12px; border-radius:999px; border:1px solid var(--line);
      background:rgba(255,255,255,.04); color:var(--text);
      cursor:pointer; font-size:13px;
    }
    .btn:hover{border-color:rgba(125,211,252,.35); background:rgba(255,255,255,.07);}
    .hint{font-size:12px; color:var(--muted);}
    #map{ height: calc(100vh - 58px); }
    .pill{
      padding:8px 10px; border-radius:999px; border:1px dashed var(--line);
      font-size:12px; color:var(--muted);
    }
  </style>
</head>
<body>
  <header>
    <div class="left">
      <button class="btn" onclick="location.href='./index.html'">â† í™ˆ</button>
      <button class="btn" id="locBtn">ğŸ“ ë‚´ ìœ„ì¹˜</button>
      <span class="pill">ëª¨ë°”ì¼ì—ì„œ ë” ì •í™•</span>
    </div>
    <div class="hint">ìœ„ì¹˜ ê¶Œí•œì„ í—ˆìš©í•˜ë©´ ì£¼ë³€ êµíšŒê°€ í•œëˆˆì— ë³´ì—¬ìš”</div>
  </header>

  <div id="map"></div>

  <script>
    window.addEventListener('load', async () => {
      // ì§€ë„ ê¸°ë³¸ ì„¸íŒ… (ì„œìš¸ ì‹œì²­ ê·¼ì²˜)
      const map = L.map('map').setView([37.5665, 126.9780], 12);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap'
      }).addTo(map);

      let myMarker = null;

      // (ì˜µì…˜) êµíšŒ ë°ì´í„° ë¡œë“œ: /data/churches.geojson ìˆìœ¼ë©´ ìë™ í‘œì‹œ
      async function loadChurches() {
        try {
          const res = await fetch('./data/churches.geojson');
          if (!res.ok) return; // íŒŒì¼ ì—†ìœ¼ë©´ ì¡°ìš©íˆ ìŠ¤í‚µ
          const geo = await res.json();
          L.geoJSON(geo, {
            onEachFeature: (feature, layer) => {
              const p = feature.properties || {};
              const name = p.name || p.title || p.êµíšŒëª… || 'êµíšŒ';
              const addr = p.address || p.addr || p.ì£¼ì†Œ || '';
              layer.bindPopup(`<b>${name}</b><br>${addr}`);
            }
          }).addTo(map);
        } catch (e) {
          console.warn('êµíšŒ ë°ì´í„° ë¡œë“œ ìŠ¤í‚µ:', e);
        }
      }
      loadChurches();

      // ë‚´ ìœ„ì¹˜ í‘œì‹œ
      function locateMe() {
        if (!navigator.geolocation) {
          alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•Šì•„ìš”.');
          return;
        }
        navigator.geolocation.getCurrentPosition(
          (pos) => {
            const lat = pos.coords.latitude;
            const lng = pos.coords.longitude;

            if (myMarker) myMarker.remove();
            myMarker = L.marker([lat, lng]).addTo(map).bindPopup('ë‚´ ìœ„ì¹˜').openPopup();
            map.setView([lat, lng], 14);
          },
          (err) => {
            alert('ìœ„ì¹˜ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆê±°ë‚˜ ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆì–´ìš”. ëª¨ë°”ì¼ì—ì„œ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.');
            console.warn(err);
          },
          { enableHighAccuracy: true, timeout: 10000 }
        );
      }

      document.getElementById('locBtn').addEventListener('click', locateMe);
      // ì²˜ìŒ ì ‘ì† ì‹œ ìë™ìœ¼ë¡œ í•œ ë²ˆ ì‹œë„í•˜ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ ì£¼ì„ í•´ì œ
      // locateMe();
    });
  </script>
</body>
</html>
